;/*!/widget/ui/admanager/ad/ad.js*/
define("common:widget/ui/admanager/ad/ad",function(n){var e=n("common:widget/ui/base/base"),i=(n("common:widget/ui/base/utils"),n("common:widget/ui/base/events")),t=e.extend({_clickHandler:function(n){t.doAction(),n.preventDefault()},init:function(){},doAction:function(){},show:function(){},hide:function(){},update:function(){},receive:function(){},resetsize:function(){},appendTo:function(n){this.$el.appendTo(n)}},i);return t});
;/*!/widget/ui/admanager/smaad/label.js*/
define("common:widget/ui/admanager/smaad/label",function(t){function n(t,n){return t.replace(/#{(\w+)}/g,function(t,i){return void 0===n[i]?"":n[i]})}function i(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);return n.join("&")}function e(t){this.opt=t,this.tpl='<li class="#{type}"><span>#{idx}</span><a href="#{link}" target="_blank">#{subutf8}</a></li>',this.$el=o(n(this.tpl,this.compute()))}var o=t("common:widget/ui/base/base");return o.extend(e.prototype,{compute:function(){var t=this.opt,n=t.subutf8,e=t.size,o=t.idx,a=n.replace(/[^\x00-\xff]/g,"aa").length,s="s"==e&&a>10?"s":"l",r="http://shangjia.baidu.com/s",u="type-"+Math.min(o+1,4);return r=r+"?"+i({wd:t.gbk,channel:"pic-detail",qid:t.qid,sid:"0",pos:"im-"+t.idx,sugCount:t.count,overscreen:1}),{boxSize:e,fontSize:s,color:t.color,subutf8:n,link:r,idx:o+1,type:u}},appendTo:function(t){this.$el.appendTo(t)}}),e});
;/*!/widget/ui/admanager/smaad/labelpic.js*/
define("common:widget/ui/admanager/smaad/labelpic",function(t){function i(t,i){return t.replace(/#{(\w+)}/g,function(t,e){return void 0===i[e]?"":i[e]})}function e(t){var i=[];for(var e in t)t.hasOwnProperty(e)&&i.push(e+"="+t[e]);return i.join("&")}function a(t){return this.opt=t,this.tpl='<li class="sma-item"><div class="picbox"><span class="pic-loading-dot" style="display: none;"></span><a href="#{link}" target="_blank"><img class="smaimg" data-src="#{picurl}" src="#{picurl}" /></a></div><h6 class="sma-item-title"><span class="sma-item-title-bg"></span><a href="#{link}" target="_blank" title="#{subutf8}">#{subutf8}</a></h6></li>',this.$el=n(i(this.tpl,this.compute())),this.$el}var n=t("common:widget/ui/base/base");return n.extend(a.prototype,{compute:function(){var t=this.opt,i=t.subutf8,a=t.size,n=t.idx,s=i.replace(/[^\x00-\xff]/g,"aa").length,l="s"==a&&s>10?"s":"l",o="http://shangjia.baidu.com/s",r="type-"+Math.min(n+1,4);return o=o+"?"+e({wd:t.gbk,channel:"pic-detail",qid:t.qid,sid:"1",pos:"im-"+t.idx,sugCount:t.count,overscreen:1}),{boxSize:a,fontSize:l,color:t.color,subutf8:i,link:o,idx:n+1,type:r,picurl:t.picurl}},appendTo:function(t){this.$el.appendTo(t)}}),a});
;/*!/widget/ui/admanager/smaad/smaad.js*/
define("common:widget/ui/admanager/smaad/smaad",function(e){function i(e,i,a){i=i||".sma-container",a=a||".sma-body",this.$el=t(i),this.$body=this.$el.find(a),this.pageModel=e}var t=e("common:widget/ui/base/base"),a=e("common:widget/ui/admanager/smaad/label"),n=e("common:widget/ui/admanager/smaad/labelpic"),d=e("common:widget/ui/admanager/ad/ad"),s=e("common:widget/ui/imghelper/imghelper");return t.extend(i.prototype,d,{init:function(){this.getData()},getData:function(){var e=this.pageModel.get("smaPic"),i=e&&e.fdi_PicResultArray&&t.isArray(e.fdi_PicResultArray)&&e.fdi_PicResultArray.length,a=encodeURIComponent(this.pageModel.get("word")),n=this;t.ajax({url:"http://image.baidu.com/sma?smafr=2&q="+a,dataType:"jsonp",jsonp:"jsonpcallback",success:function(t){t&&t.length>0?(n.data=t,i&&i>1&&n.data.length>1?(n.picListData=e.fdi_PicResultArray,n.renderPic()):n.render()):n.hide()},error:function(){n.hide()}})},render:function(e){this.$body.empty(),e=e||this.data||[];var i=e.slice(0,6),n=0,d=i.length,s=null,o=null;if(3>=d)this.hide();else for(this.show(),n=0;d>n;n++)s=i[n],s=t.extend({subutf8:s.utf8,idx:n,count:d,qid:this.pageModel.get("aspSID")},s),o=new a(s),o.appendTo(this.$body)},renderPic:function(e){var i=this;this.$body.empty(),e=e||this.data||[];var a=this.picListData||[],d=e.slice(0,4),o=a.slice(0,4),r=0,l=d.length,c=null,h=null,u=o.length,m=Math.min(2*parseInt(l/2),2*parseInt(u/2));if(1>=m)this.hide();else{var p=function(){var e=t("<ul></ul>"),a=t.Deferred(),l=0;for(r=0;m>r;r++)c=d[r],c=t.extend({subutf8:c.utf8,idx:r,count:m,qid:i.pageModel.get("aspSID"),picurl:o[r].AdPicUrl},c),function(i,d,o){s.loadImage([o.picurl],function(i){l++,h=t(new n(o)).appendTo(e);var r=s.scaleFull(i,{width:118,height:88});h.find(".pic-loading-dot").hide(),h.find(".smaimg").css(r).attr("src",o.picurl),l>=d&&a.resolve(e)})}(r,m,c);return a};p().then(function(e){i.$body.parent().addClass("sma-container-pic"),i.$body.empty().append(e.children()),i.show()})}},show:function(){this.$el.show()},hide:function(){this.$el.hide()}}),i});
;/*!/widget/ui/admanager/aldview/aldview.js*/
define("common:widget/ui/admanager/aldview/aldview",function(e){function t(e,t,n,a){this.$el=i(t),this.defaultOpts={width:350,height:183},this.pageModel=e,this.container=null,this.options=i.extend({},this.defaultOpts,a||{})}var i=e("common:widget/ui/base/base"),n=e("common:widget/ui/admanager/ad/ad");return i.extend(t.prototype,n,{init:function(){return ecom.ma.image.ald.getArea()},render:function(){}}),t});
;/*!/widget/ui/admanager/pullEcom/pullEcom.js*/
define("common:widget/ui/admanager/pullEcom/pullEcom",function(t){function a(t,a){this.$el=e(a),this.pageModel=t}var e=t("common:widget/ui/base/base"),i=t("common:widget/ui/admanager/ad/ad");return e.extend(a,i,{_clickHandler:function(t){this.doAction(t)},init:function(){this.$el.bind("click",this._clickHandler),this.addImg()},doAction:function(t){e(t.target)},addImg:function(){var t,a,i,d,n;try{n=ecom.ma.image.TopBackground,t=n.getPrimaryBack(),a=n.getSecondaryBack(),d=parseInt(n.getSecondaryHeight())||0,i=parseInt(n.getPrimaryHeight())||0}catch(r){return}if(t&&!(1>i)){var c=e("<div></div>");if(c.addClass("ma-primary-bg"),c.css({background:t,height:i}),c.appendTo(e("body")),a&&d>0){var s=e("<div></div>");s.addClass("ma-repeat-bg"),s.css({height:d,background:a}),s.appendTo(e("body"))}var o,g;this.addEventListener("stratrgy",function(t){if(t&&t.state&&"resize"===t.state.type){var a=t.state.currentViewWidth||0;a>0&&a!==o&&(o=a,c&&c.css({width:o}),s&&s.css({width:o}));try{if(t&&t.state&&("resize"===t.state.type||"ini"===t.state.type)){var e=t.state.currImgLineWidth||0;e>0&&e!==g&&(g=e,n.updataEcomBackground&&n.updataEcomBackground({bgDiv:c,repeatDOM:s,currImgLineWidth:g,state:t.state}))}}catch(i){}}})}}}),a});
;/*!/widget/ui/admanager/smead/smead.js*/
define("common:widget/ui/admanager/smead/smead",function(t){function e(t,e,d,a){this.defaultOpts={SME_WIDTH:165,SME_HEIGHT:169},this.defaultId={el:"smeContainer",body:"imgid"},this.pageModel=t,this.options=i.extend({},this.defaultOpts,a||{})}var i=t("common:widget/ui/base/base"),d=t("common:widget/ui/admanager/ad/ad");return i.extend(e.prototype,d,{init:function(){this.$el=i(el)||i(this.defaultId.el),this.$body=this.$el.find(body||this.defaultId.body)},render:function(t,e){var i=this.pageModel.get("sme")-0;if(i&&this.$el&&this.$body){var d,a,s,n=this.$el.find("dl"),o=this.options.SME_HEIGHT,l=this.options.SME_WIDTH;for(d=0,a=0,s=e.length;s>d&&d<n.length;d++){var h=e[d];if(h.pageNum>=0)break;if("SME"==h.type){var p=n.eq(e[d].className).clone(!0),m=Math.max(h.liHeight+4-o/2,0),f=Math.min(Math.max((h.liWidth+8-l)/2,0),5);p.addClass("pull-sme"),p.css({position:"absolute",top:h.top,left:h.left+5-f-(l-h.liWidth-8)/2,paddingTop:m,paddingBottom:m,paddingLeft:f,paddingRight:f}),this.$el.append(p),a++}}}}}),e});
;/*!/widget/ui/admanager/ecomimad/ecomimad.js*/
define("common:widget/ui/admanager/ecomimad/ecomimad",function(require,exports,module){function ecomimad(t){this.$el=$("#imContainer"),this.$title=$("#adCard .card-title"),this.$titleprev=$("#adCard .card-title .sticker"),this.$titleclose=$("#adCard .card-title .close"),this.titletxt=document.createTextNode("读图推广"),this.pageModel=t,this.requestUrl="/search/aspdetail?"}var $=require("common:widget/ui/base/base"),utils=require("common:widget/ui/base/utils"),events=require("common:widget/ui/base/events"),Ad=require("common:widget/ui/admanager/ad/ad");return $.extend(ecomimad.prototype,Ad,{init:function(){this.tempImgUrl=""},getData:function(t,a){if(t&&1==t.hasAspData){var e={tn:"baiduaspdetail",word:this.pageModel.data.word,ie:"utf-8",objurl:t.objURL};$.ajax({url:this.requestUrl,data:e,success:function(t){a&&a(t)},error:function(){}})}},update:function(imgData,imgModel){this.timer&&clearTimeout(this.timer);var that=this;this.timer=setTimeout(function(){that.getData(imgData,function(data){var jsonData=data;if("string"==typeof data)try{jsonData=eval("("+data+")")}catch(e){return}if(jsonData&&jsonData[70002]){that.$el.html(jsonData[70002]),that.$adTitTpl||(that.$adTitTpl=$(document.createDocumentFragment()),that.$adTitTpl.append(that.$titleprev),that.$adTitTpl.append(that.titletxt),that.$adTitTpl.append(that.$titleclose),that.$title.empty().append(that.$adTitTpl));var $adCard=$("#adCard");$adCard&&$adCard.length&&"hidden"===$adCard.css("visibility")&&$adCard.css("visibility","visible"),$(document.body).trigger("ecomLoaded")}})},40)},getSam:function(t){var a=0;t=t||$.cookie("BAIDUID"),t=t.replace(":FG=1",""),t+=":FG=1";for(var e=0;e<t.length;e++)a=31*a+t.charCodeAt(e),a%=4294967296;var i=a%101;return i}}),ecomimad});
;/*!/widget/ui/admanager/manifest.js*/
define("common:widget/ui/admanager/manifest",function(a){var m=a("common:widget/ui/admanager/smaad/smaad"),e=a("common:widget/ui/admanager/aldview/aldview"),d=a("common:widget/ui/admanager/pullEcom/pullEcom"),i=a("common:widget/ui/admanager/smead/smead"),n=a("common:widget/ui/admanager/ecomimad/ecomimad"),o={smaad:m,aldview:e,pullEcom:d,smead:i,ecomimad:n},c={get:function(a){return o[a]}};return c});
;/*!/widget/ui/admanager/admanager.js*/
define("common:widget/ui/admanager/admanager",function(i){var e=i("common:widget/ui/base/base"),n=i("common:widget/ui/admanager/manifest"),t=i("common:widget/ui/base/events"),a={},o=e.extend({init:function(i,e,n){this.pageModel=i,this.el=e,this.body=n||""},initAd:function(i,e){var t;return e=e||n.get(i),e instanceof Function&&(t=new e(this.pageModel,this.el,this.body)),t.init(),a[i]=t,t},initAds:function(i){for(var e in i){var t=i[e],a=n.get(t);a instanceof Function&&this.initAd(t,a)}},update:function(i,e){var i=e.get("imgData");if(i)for(var n in a){var t=a[n];t.update(i,e)}},resetsize:function(){for(var i in a){var e=a[i];e.resetsize()}},receive:function(i,e){for(var n in a){var t=a[n];t.receive(i,e)}}},t);return o});
;/*!/widget/ui/admanager/eyeball/eyeball.js*/
define("common:widget/ui/admanager/eyeball/eyeball",function(t){function e(t){this.params=t,this.pageList=[],this.pageListId=[],this.startPnList=[],this._adInited=!1,this._currentImgInfo=null,this.initNameSpace()}function i(t,i){i&&(this.$el=n(i)),this.pageModel=t,this.ecomAd=new e({word:t.get("word"),adexp:1*t.get("adexp")}),this.timer=null}var n=t("common:widget/ui/base/base"),a=t("common:widget/ui/base/utils"),s=t("common:widget/ui/base/events"),o=t("common:widget/ui/admanager/ad/ad");return n.extend(e.prototype,s,{initNameSpace:function(){window.ns=window.ns||{},ns=window.ns,that=this,ns.image=ns.image||{},ns&&ns.image&&(ns.image.getQuery=function(){return encodeURIComponent(that.params.word)},ns.image.getDomByImgId=function(){return document.getElementById("srcPic")},ns.image.event={},ns.image.event.addListener=function(t,e){that.addEventListener(t,a.throttle(function(i){setTimeout(function(){e(t,i)},0)},100))},ns.image.event.trigger=function(t,e){that.dispatchEvent(t,e)},ns.image.pageList=this.pageList,ns.image.pageListId=this.pageListId,ns.image.startPnList=this.startPnList)},loadAd:function(t){var e=this;e._adInited=!0;try{ecom.ma.adLoader.load(t,function(){for(var t=e.pageList,i=e.pageListId,n=e.startPnList,a=t.length,s=0;a>s;s++){var o=t[s],m=i[s],d=n[s];o&&e.dispatchEvent("SHOW_IMAGE_PROMOTION",{startPn:d,imaURLs:o,imageIds:m})}e._currentImgInfo&&setTimeout(function(){e.updateImg(e._currentImgInfo)},100)})}catch(i){}},load:function(){var t=this;setTimeout(function(){t.loadAd.call(t,"imageplus")},10)},appendImgs:function(t){if(!this._adInited){var e=window.ns;this.pageListId.length||(e.image.firstPageList=t.imageIds),e.image.startPn=t.startPn,this.pageList.push(t.imaURLs),this.pageListId.push(t.imageIds),this.startPnList.push(t.startPn)}this.dispatchEvent("SHOW_IMAGE_PROMOTION",t)},updateImg:function(t){var e=this;void 0!=e.spn&&(t=n.extend({},{spn:e.spn},t)),void 0!=e.duxinTag&&(t=n.extend({},{duxinTag:e.duxinTag},t)),this._currentImgInfo=t,this.dispatchEvent("SHOW_IMAGE_DETAIL",t)}}),n.extend(i.prototype,o,{init:function(){this.tempImgUrl=""},update:function(t,e){this.timer&&clearTimeout(this.timer);var i=this,n=e.get("imgData");this.timer=setTimeout(function(){var t,a="",s=n.objURL||0,o="resize",m=n.hoverURL||n.thumbURL;i.tempImgUrl!=s&&(o="change",i.tempImgUrl=s),m&&(t=m.match(/u=(\d+,\d+)/i),t&&t.length&&(a=t[1])),this.duxinTag=i.ecomAd.duxinTag=n.srv_auto&&n.srv_auto.name||n["srv_auto-brand"]&&n["srv_auto-brand"].name||n.srv_sight&&n.srv_sight.sight,i.spn=i.ecomAd.spn=e.get("spn"),i.imgContentSign=a,i.zoom=e.get("scale"),i.objURL=n.objURL,i.imaURL=s,i.pn=n.pn,i.ecomAd.updateImg({imaId:a,zoom:e.get("scale"),etype:o,objURL:n.objURL,imaURL:s,pn:n.pn})},10)},resetsize:function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.ecomAd.updateImg({imaId:t.imgContentSign,zoom:t.zoom,etype:"resize",objURL:t.objURL,imaURL:t.imaURL,pn:t.pn})},10)},receive:function(t,e){var i,a=[],s=[];n(e).each(function(t,e){a.push(e.objURL);var n=e.hoverURL||e.thumbURL;n&&(i=n.match(/u=(\d+,\d+)/i),i&&i.length&&s.push(i[1]))}),this.ecomAd.appendImgs({startPn:t,imaURLs:a,imageIds:s}),this.ecomAd._adInited||this.ecomAd.load()}}),i});